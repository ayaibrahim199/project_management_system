<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${team.name} + ' - Team'">Team Details</title>
    <link rel="stylesheet" th:href="@{/css/style.min.css}">
    <link rel="stylesheet" th:href="@{/css/style.enhancements.css}">
</head>
<body>
    <header th:replace="~{fragments/navbar :: navbar}"></header>
    <main class="container">
        <section class="page-header">
            <h1>
                <span th:text="${team.name}">Team Name</span>
            </h1>
            <div style="display:flex;gap:10px;align-items:center;">
                <a th:href="@{/teams/edit/{id}(id=${team.id})}" class="btn-create">‚úèÔ∏è Edit</a>
                <a th:href="@{/teams}" class="btn-small" style="background:transparent;color:var(--muted);border:1px solid rgba(11,26,43,0.06);">‚Üê Back to Teams</a>
            </div>
        </section>

        <div style="margin-bottom:18px;color:var(--muted);font-size:14px;">
            <strong>Created:</strong> <span th:text="${#temporals.format(team.createdAt, 'MMM dd, yyyy')}">Date</span>
            &nbsp;&nbsp;‚Ä¢&nbsp;&nbsp;
            <strong>Team Lead:</strong> <span th:text="${team.teamLead.username}">Lead Name</span>
            &nbsp;&nbsp;‚Ä¢&nbsp;&nbsp;
            <strong>Total Members:</strong> <span th:text="${team.members != null ? team.members.size() : 0}">0</span>
        </div>

        <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>
        <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

        <div class="teams-grid">
            <div class="team-card">
                <div class="team-card-header">
                    <h3 class="team-name">üë• Team Members</h3>
                    <span class="team-badge" th:text="${team.members != null ? team.members.size() : 0}">0</span>
                </div>

                <div th:if="${team.members.isEmpty()}" class="empty-state">
                    <div class="empty-state-icon">üë•</div>
                    <div>No members yet. Add members to start collaborating.</div>
                </div>

                <div th:if="${!team.members.isEmpty()}">
                    <ul class="members-list">
                        <li th:each="member : ${team.members}" style="padding:10px 0;border-bottom:1px solid #f3f4f6;display:flex;justify-content:space-between;align-items:center;">
                            <div>
                                <div style="font-weight:700;color:#0b1a2b;" th:text="${member.username}">Username</div>
                                <div style="font-size:13px;color:var(--muted);" th:text="${member.email}">email@example.com</div>
                            </div>
                            <div style="display:flex;gap:8px;align-items:center;">
                                <span th:if="${member.id == team.teamLead.id}" class="team-badge">Lead</span>
                                <div th:if="${member.id != team.teamLead.id}">
                                    <form th:action="@{/teams/{teamId}/members/remove/{userId}(teamId=${team.id}, userId=${member.id})}" method="post" style="display:inline;">
                                        <button type="submit" class="btn-small btn-delete" onclick="return confirm('Remove this member?');">Remove</button>
                                    </form>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="add-member-form" style="margin-top:12px;">
                    <form th:action="@{/teams/{teamId}/members/add(teamId=${team.id})}" method="post" style="display:flex;gap:8px;">
                        <select name="userId" required style="flex:1;padding:10px;border:1px solid #e6e9ef;border-radius:8px;">
                            <option value="">Select user to add...</option>
                            <option th:each="user : ${availableUsers}" th:value="${user.id}" th:text="${user.username}">User</option>
                        </select>
                        <button type="submit" class="btn-small btn-view" style="background:#28a745;color:#fff;border:none;padding:8px 12px;border-radius:8px;">Add Member</button>
                    </form>
                </div>
            </div>

            <div class="team-card">
                <div class="team-card-header">
                    <h3 class="team-name">üìã Projects</h3>
                </div>

                <div th:if="${team.projects.isEmpty()}" class="empty-state">
                    <div class="empty-state-icon">üìÅ</div>
                    <div>No projects assigned yet.</div>
                </div>

                <div th:if="${!team.projects.isEmpty()}">
                    <ul class="projects-list" style="list-style:none;padding:0;margin:0;">
                        <li th:each="project : ${team.projects}" style="padding:10px 0;border-bottom:1px solid #f3f4f6;display:flex;justify-content:space-between;align-items:center;">
                            <a th:href="@{/projects/{id}(id=${project.id})}" class="project-name" th:text="${project.title}" style="font-weight:700;color:var(--accent-2);text-decoration:none;">Project Name</a>
                            <span class="team-badge" th:text="${project.status}">Active</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Project Management System. All rights reserved.</p>
    </footer>
</body>
</html>
